# 第4回　推測統計②


#### ■ 問1　一致性と不偏性
<b>一致性</b>
標本サイズnを無限大にすると、推定量が母集団の真の値と一致する。
例：$i$回目に出たサイコロの目を$x_{i}$とする。
$$
\frac{1}{n+10}\sum_{i=1}^{n}x_{i}
$$
<img src="12.png" width="500">

<b>不偏性</b>
標本サイズnの値にかかわらず、推定量の平均値（期待値）が母集団の真の値と一致する。
例：$i$回目に出たサイコロの目を$x_{i}$とする。
$$
\frac{x_{1}+x_{2}}{2}
$$
<img src="09.png" width="500">

<u>一致性も不編性もある推定量</u>
例：$i$回目に出たサイコロの目を$x_{i}$とする。
$$
\frac{1}{n}\sum_{i=1}^{n}x_{i}
$$
<img src="10.png" width="500">

■ 解答
1.$\mu_{3}$, $\mu_{4}$

2.$\mu_{1}$, $\mu_{2}$, $\mu_{3}$

#### ■ 問2　不偏分散と自由度
<b>自由度</b>
統計量を算出する際、標本の中で独立に値を変化させられる数のこと。

例
5つのデータの値とその平均値を使うとき、4つのデータの値が決まれば、平均値から残り1つの値が自動的に決まる。
すなわち、残り1つは独立に値を変化させられない。
よって自由度は5-1=4。

<b>不偏分散</b>
標本から母集団の分散を推定するための不偏推定量。

$$s^{2} = \frac{1}{n-1}\sum_{i=1}^{n} (x_{i} - \bar x)^{2}$$

※母分散
$$\sigma^{2} = \frac{1}{n}\sum_{i=1}^{n} (x_{i} - \mu)^{2}$$

※標本分散
$$V = \frac{1}{n}\sum_{i=1}^{n} (x_{i} - \bar x)^{2}$$

標本分散を計算すると、標本分散は母分散の$\frac{n-1}{n}$倍になる。
よって標本分散は母分散よりも常に小さいため、標本分散を母分散の推定量とすると、偏りのある推定量となってしまう（不偏性がなくなる）。
従って、推定量としては標本分散を$\frac{n}{n-1}$倍した不偏分散を用いる。

■ 解答
1.自由度：5
標本数6 - 1 = 5

2.標本分散：1.717
平方和S
$$
\begin{align}
S &= (8.0^{2} + 5.4^{2} + 3.6^{2} + 5.8^{2} + 6.4^{2} + 6.2^{2}) - \frac{(8.0 + 5.4 + 3.6 + 5.8 + 6.4 + 6.2)^{2}}{6}\\
&= (64 + 29.16 + 12.96 + 33.64 + 40.96 + 38.44) - \frac{1253.16}{6}\\
&= 219.16 - 208.86\\
&= 10.3
\end{align}
$$

標本分散$V$
$$
\begin{align}
V &= \frac{S}{n}\\
&= \frac{10.3}{6}\\
&= 1.717
\end{align}
$$

3.不偏分散：2.06
$$
\begin{align}
s^{2} &= \frac{S}{n - 1}\\
&= \frac{10.3}{5}\\
&= 2.06
\end{align}
$$

4.標本分散より、不偏分散の方が大きい


#### ■ 問3　Pythonを使って不偏分散の算出

Notebook参照

#### ■ 問4　母平均の推定（母分散既知）
<b>点推定</b>
標本を使って、未知の母数をある1点で予測すること。

<b>区間推定</b>
標本を使って、未知の母数の存在範囲を区間として予測すること。

<b>信頼区間</b>
母数が含まれる数値の範囲。

<b>信頼係数</b>
母数が信頼区間の範囲に含まれる確率。

<b>区間推定の流れ</b>
母集団が$N(\mu, \sigma^{2})$に従うとき、標本平均$
\bar{x}$は$N(\mu, \frac{\sigma^{2}}{n})$に従う。（第3回「標本平均の分布」）
さらに、$u = \frac{\bar{x}-\mu}{\sqrt{\sigma^{2}/n}}$は$N(0, 1^{2})$に従う。（第3回「標本平均の標準化」）

①標本平均を標準化する。
②信頼係数95%の場合、標準化した値が標準正規分布の真ん中95%の面積の範囲にあれば良い。
③すなわち、左側2.5%、右側2.5%に入らなければ良い。
④正規分布は左右対称なので、正の値の右側2.5%(0.025)の位置を標準正規分布表から調べる。
⑤標準正規分布表から、1.96が右側2.5%の位置だとわかる。（-1.96が左側2.5%の位置）
⑥$-1.96\leq\frac{\bar{x}-\mu}{\sqrt{\sigma^{2}/n}}\leq1.96$が信頼係数95%の信頼区間となる。
⑦これを$\mu$について解くと、$\bar{x}-1.96\sqrt{\frac{\sigma^{2}}{n}}\leq\mu\leq\bar{x}+1.96\sqrt{\frac{\sigma^{2}}{n}}$となる。
⑧これが求めたい信頼区間となる。

<img src="03.png" width="500">


■ 解答
1.　母平均の点推定：10.3
$$
\begin{align}
\hat{\mu} &= \frac{10.3 + 10.5 + 9.8 + 10.2 + 10.4 + 10.8 + 10.7 + 10.7 + 9.7 + 9.9}{10}\\
&= 10.3
\end{align}
$$

2.　95%信頼区間：(10.05, 10.55)
まず、標準化した標本平均$u$を考える。
$$u = \frac{\bar{x}-\mu}{\sqrt{\sigma^{2}/n}}$$
（数値は最後に代入するのがオススメです）

次に、右側2.5%(0.025)の位置を標準正規分布表から調べる。
<img src="04.png" width="700">

1.96だとわかったので、$-1.96\leq\frac{\bar{x}-\mu}{\sqrt{\sigma^{2}/n}}\leq1.96$が信頼係数95%の信頼区間。
これを$\mu$について解く。
$$
-1.96\leq\frac{\bar{x}-\mu}{\sqrt{\sigma^{2}/n}}\leq1.96\\
\,\\
-1.96\sqrt{\frac{\sigma^{2}}{n}}\leq\bar{x}-\mu\leq1.96\sqrt{\frac{\sigma^{2}}{n}}\\
\,\\
-\bar{x}-1.96\sqrt{\frac{\sigma^{2}}{n}}\leq-\mu\leq-\bar{x}+1.96\sqrt{\frac{\sigma^{2}}{n}}\\
\,\\
\bar{x}+1.96\sqrt{\frac{\sigma^{2}}{n}}\geq\mu\geq\bar{x}-1.96\sqrt{\frac{\sigma^{2}}{n}}\\
\,\\
\bar{x}-1.96\sqrt{\frac{\sigma^{2}}{n}}\leq\mu\leq\bar{x}+1.96\sqrt{\frac{\sigma^{2}}{n}}
$$となる。

最後に、文字に値を代入して信頼区間を求める。
$\bar{x} = 10.3, n=10, \sigma^{2} = 0.4$より、
$$
10.3-1.96\sqrt{\frac{0.4^{2}}{10}}\leq\mu\leq10.3+1.96\sqrt{\frac{0.4^{2}}{10}}\\
\,\\
10.3-1.96×0.126\leq\mu\leq10.3+1.96×0.126\\
\,\\
10.05\leq\mu\leq10.55
$$
よって、95%信頼区間は(10.05, 10.55)

※95%信頼区間の意味
母平均は確率変数ではなく定数なので、母平均が確率的に変化することはない。
95%信頼区間は
「求めた信頼区間の中に母平均が95%の確率で含まれる」ではなく、
「様々な標本を抽出して信頼区間を求めると、95%の信頼区間は母平均を含む」という意味。

<img src="11.png" width="700">


#### ■ 問5　Pythonを使って母平均の推定（母分散既知）

Notebook参照

#### ■ 問6　母平均の推定（母分散未知）
<b>区間推定の流れ</b>
母集団が$N(\mu, \sigma^{2})$に従うとき、標本平均$
\bar{x}$は$N(\mu, \frac{\sigma^{2}}{n})$に従う。（第3回「標本平均の分布」）
よって、$u = \frac{\bar{x}-\mu}{\sqrt{\sigma^{2}/n}}$は$N(0, 1^{2})$に従う。（第3回「標本平均の標準化」）
ただし、この場合は母分散$\sigma^{2}$が不明なので、代わりに標本から算出した不偏分散$s^{2}$を使う。
このとき、$t = \frac{\bar{x}-\mu}{\sqrt{s^{2}/n}}$は自由度$n - 1$の$t$分布に従う。

t分布の特徴
・左右対称
・自由度が小さい（標本数が小さい）と裾野が広くなる
・自由度が十分大きい（標本数が非常に大きい）とき、標準正規分布と一致する。

<img src="05.png" width="500">

①統計量$t$の式を考える（操作は標本平均の標準化と同じ）。
②信頼係数95%の場合、統計量$t$が$t$分布の真ん中95%の面積の範囲にあれば良い。
③すなわち、左側2.5%、右側2.5%に入らなければ良い。
④$t$分布は左右対称なので、自由度$m$のときの正の値の右側2.5%(0.025)の位置を$t$分布表から調べる。
⑤$t$分布表から、自由度9のときの右側2.5%の位置は2.262だとわかる。（-2.262が左側2.5%の位置）
⑥$-2.262\leq\frac{\bar{x}-\mu}{\sqrt{s^{2}/n}}\leq2.262$が信頼係数95%の信頼区間となる。
⑦これを$\mu$について解くと、$\bar{x}-2.262\sqrt{\frac{s^{2}}{n}}\leq\mu\leq\bar{x}+2.262\sqrt{\frac{s^{2}}{n}}$となる。
⑧これが求めたい信頼区間となる。

■ 解答
1.　母平均の点推定：10.3
$$
\begin{align}
\hat{\mu} &= \frac{10.3 + 10.5 + 9.8 + 10.2 + 10.4 + 10.8 + 10.7 + 10.7 + 9.7 + 9.9}{10}\\
&= 10.3
\end{align}
$$

2.　95%信頼区間：(10.02, 10.58)
まず、統計量$t$を考える。
$$t = \frac{\bar{x}-\mu}{\sqrt{s^{2}/n}}$$

次に、自由度9の右側2.5%(0.025)の位置を$t$分布表から調べる。
<img src="06.png" width="500">

2.262だとわかったので、$-2.262\leq\frac{\bar{x}-\mu}{\sqrt{s^{2}/n}}\leq2.262$が信頼係数95%の信頼区間。
これを$\mu$について解く。
$$
-2.262\leq\frac{\bar{x}-\mu}{\sqrt{s^{2}/n}}\leq2.262\\
\,\\
\bar{x}-2.262\sqrt{\frac{s^{2}}{n}}\leq\mu\leq\bar{x}+2.262\sqrt{\frac{s^{2}}{n}}
$$となる。

最後に、文字に値を代入して信頼区間を求める。
$$
\begin{align}
s^{2} &= \frac{(10.3 - 10.3)^{2} + (10.5 - 10.3)^{2} + (9.8 - 10.3)^{2} + (10.2 - 10.3)^{2} + (10.4 - 10.3)^{2} + (10.8 - 10.3)^{2} + (10.7 - 10.3)^{2} + (10.7 - 10.3)^{2} + (9.7 - 10.3)^{2} + (9.9 - 10.3)^{2}}{10 - 1}\\
&= \frac{0^{2} + 0.2^{2} + (-0.5)^{2} + (-0.1)^{2} + 0.1^{2} + 0.5^{2} + 0.4^{2} + 0.4^{2} + (-0.6)^{2} + (-0.4)^{2}}{9}\\
&= 0.1556
\end{align}
$$

$\bar{x} = 10.3, n=10, s^{2} = 0.1556$より、
$$
10.3-2.262\sqrt{\frac{0.1556}{10}}\leq\mu\leq10.3+2.262\sqrt{\frac{0.1556}{10}}\\
\,\\
10.3-2.262×0.124\leq\mu\leq10.3+2.262×0.124\\
\,\\
10.02\leq\mu\leq10.58
$$
よって、95%信頼区間は(10.02, 10.58)


#### ■ 問7　Pythonを使って母平均の推定（母分散未知）

Notebook参照

#### ■ 問8　母分散の推定

<b>区間推定の流れ</b>
母集団が$N(\mu, \sigma^{2})$に従うとき、その標本から得られる分散も何らかの分布を持つ。
ただし、分散はデータを2乗したものの和なので、正規分布のような分布には従わない。
このとき、$\chi^{2} = \frac{S}{\sigma^{2}} = \frac{(n-1)s^{2}}{\sigma^{2}}$は自由度$n - 1$の$\chi^{2}$分布に従う。

※$\chi^{2}$は標準正規分布に従う標本の2乗の和
$$
\chi^{2} = \sum_{i=1}^{n} \Bigl(\frac{x_{i} - \mu}{\sigma}\Bigr)^{2} = \frac{1}{\sigma^{2}} \sum_{i=1}^{n} (x_{i} - \mu)^{2} = \frac{S}{\sigma^{2}}
$$


$\chi^{2}$分布の特徴
・左右対称ではない
・自由度によって分布の形が大きく異なる

<img src="07.png" width="700">

①統計量$\chi^{2}$の式を考える（平方和または不偏分散）。
②信頼係数95%の場合、統計量$\chi^{2}$が$\chi^{2}$分布の真ん中95%の面積の範囲にあれば良い。
③すなわち、左側2.5%(右側97.5%)、右側2.5%に入らなければ良い。
④$\chi^{2}$分布は左右対称ではないので、自由度$m$のときの2.5%(0.025)の位置と97.5%(0.0975)の位置を$\chi^{2}$分布表から調べる。
⑤$\chi^{2}$分布表から、自由度9のときの97.5%の位置は2.70、2.5%の位置は19.02だとわかる。
⑥$2.70\leq\frac{S}{\sigma^{2}}\leq19.02$が信頼係数95%の信頼区間となる。
⑦これを$\sigma^{2}$について解くと、$\frac{S}{19.02}\leq\sigma^{2}\leq\frac{S}{2.70}$となる。
⑧これが求めたい信頼区間となる。

■ 解答
1.　母分散の点推定：0.5
標本平均$\bar{x} = 9.5$
$$
\begin{align}
s^{2} &= \frac{(10 - 9.5)^{2} + (9 - 9.5)^{2} + (9 - 9.5)^{2} + (9 - 9.5)^{2} + (10 - 9.5)^{2} + (10 - 9.5)^{2} + (11 - 9.5)^{2} + (9 - 9.5)^{2} + (9 - 9.5)^{2} + (9 - 9.5)^{2}}{10 - 1}\\
&= \frac{0.5^{2} + 0.5^{2} + 0.5^{2} + 0.5^{2} + 0.5^{2} + 0.5^{2} + 1.5^{2} + 0.5^{2} + 0.5^{2} + 0.5^{2}}{9}\\
&= 0.5
\end{align}
$$

2.　95%信頼区間：(10.02, 10.58)
まず、統計量$\chi^{2}$を考える。
$$
\chi^{2} = \frac{S}{\sigma^{2}}
$$

次に、自由度9の97.5%(0.975)の位置と2.5%(0.025)の位置を$\chi^{2}$分布表から調べる。
<img src="08.png" width="500">

2.70と19.02だとわかったので、$2.70\leq\frac{S}{\sigma^{2}}\leq19.02$が信頼係数95%の信頼区間。
これを$\sigma^{2}$について解く。
$$
2.70\leq\frac{S}{\sigma^{2}}\leq19.02\\
\,\\
\frac{1}{19.02}\leq\frac{\sigma^{2}}{S}\leq\frac{1}{2.70}\\
\,\\
\frac{S}{19.02}\leq\sigma^{2}\leq\frac{S}{2.70}\\
$$となる。

最後に、文字に値を代入して信頼区間を求める。
$S = (n-1)s^{2} = 4.5$より、
$$
\frac{4.5}{19.02}\leq\sigma^{2}\leq\frac{4.5}{2.70}\\
\,\\
0.24\leq\sigma^{2}\leq1.67
$$
よって、95%信頼区間は(0.24, 1.67)

#### ■ 問9　Pythonを使って母分散の推定

Notebook参照
